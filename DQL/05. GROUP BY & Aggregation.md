![NO JOIN](https://github.com/user-attachments/assets/b8765043-3255-4fec-9ba9-4173270f0158)

## 5.1	GROUP BY
When you need to **summarize** large datasetsâ€”for example, calculating totals, averages, or countsâ€”MySQLâ€™s aggregate functions together with the `GROUP BY` clause let you collapse many rows into meaningful summaries (e.g., â€œtotal sales by productâ€, â€œuser counts per countryâ€, etc.).


**GROUP BY single column -** 
```sql
SELECT 
	department, 
	COUNT(*) AS total_employees
FROM employees
GROUP BY department;
```

GROUP BY groups rows that have **the same values in specified columns**. 

**GROUP BY multiple columns -** 
SQL forms groups based on the **unique combinations** of values in those columns.

```sql
SELECT col1, col2, AGG_FUNC(col3)
FROM table
GROUP BY col1, col2;
```

Group rows by **each distinct combination of col1 and col2**, then apply the aggregate function on the grouped data.

## 5.2 HAVING - Filter After Grouping

```sql
SELECT 
	department, 
	COUNT(*) AS total
FROM employees
GROUP BY department
HAVING COUNT(*) > 10;
```

 **ðŸ”´ Invalid Use (This will cause an error):**

```sql
SELECT 
	department, 
	SUM(salary)
FROM employees
WHERE SUM(salary) > 50000  -- âŒ Not allowed
GROUP BY department;
```

**âœ… Correct Use with HAVING:**

```sql
SELECT 
	department, 
	SUM(salary) AS total_salary
FROM employees
GROUP BY department
HAVING SUM(salary) > 50000;
```

| **Clause** | **Purpose** | **Can I Use Aggregates?** |
| --- | --- | --- |
| WHERE | Filters rows **before** grouping | âŒ No |
| HAVING | Filters groups **after** aggregation | âœ… Yes |

**Why HAVING is used with GROUP BY**

**Because aggregate functions are not available before grouping**

- The WHERE clause is evaluated **before** the data is grouped using GROUP BY.
- At that point, **aggregate functions like SUM(), AVG(), COUNT() are not yet computed**.
- Therefore, you **cannot** filter based on aggregate values in the WHERE clause.

**HAVING is evaluated after GROUP BY**

- Once the groups are created using GROUP BY, **aggregate functions are computed per group**.
- Then the HAVING clause is evaluated to **filter these groups** based on aggregate results.

**Table: sales**

| **id** | **region** | **product** | **amount** |
| --- | --- | --- | --- |

```sql
SELECT region, product, SUM(amount) AS total_sales
FROM sales
WHERE amount > 100
GROUP BY region, product
HAVING SUM(amount) > 400;
```

## 5.3 AGGREGATE function

**5.3.1 Basic Aggregate Functions**

| **Function** | **Description** | **Syntax** |
| --- | --- | --- |
| `COUNT()` | Counts rows (or non-NULL values) | COUNT(*) or COUNT(column) |
| `SUM()` | Calculates the total sum of a numeric column | SUM(column) |
| `AVG()` | Calculates the average of a numeric column | AVG(column) |
| `MIN()` | Returns the minimum value in a column | MIN(column) |
| `MAX()` | Returns the maximum value in a column | MAX(column) |
| `GROUP_CONCAT()` | Concatenates strings from multiple rows into a single string, grouped by GROUP BY | GROUP_CONCAT(column SEPARATOR ', ') |

**Key Differences Between CONCAT() and GROUP_CONCAT()**

| **Feature** | CONCAT() | GROUP_CONCAT() |
| --- | --- | --- |
| Type | **Scalar function** | **Aggregate function** |
| Operates on | **Columns in a single row** | **Multiple rows within a group** |
| Used with GROUP BY? | Not required | Often used with GROUP BY |
| Example Use | Full name: CONCAT(first_name, ' ', last_name) | List of names: GROUP_CONCAT(name) |
| Returns | One string per row | One string per group |

**5.3.2 Statistical Aggregate Functions**

| `STDDEV()` | Returns the standard deviation of a numeric column | STDDEV(column) |
| --- | --- | --- |
| `STDDEV_POP()` | Standard deviation (population version, synonym of STDDEV) | STDDEV_POP(column) |
| `VARIANCE()` | Returns the statistical variance of a numeric column | VARIANCE(column) |
| `VAR_POP()` | Population variance (like VARIANCE) | VAR_POP(column) |

**5.3.3 BIT Aggregate Functions**

| `BIT_AND()` | Bitwise AND of all non-NULL values | BIT_AND(column) |
| --- | --- | --- |
| `BIT_OR()` | Bitwise OR of all non-NULL values | BIT_OR(column) |
| `BIT_XOR()` | Bitwise XOR of all non-NULL values | BIT_XOR(column) |

**5.3.4 JSON Aggregate functions**

| `JSON_ARRAYAGG()` | Aggregates values into a JSON array (MySQL 5.7+) | JSON_ARRAYAGG(column) |
| --- | --- | --- |
| `JSON_OBJECTAGG()` | Aggregates key-value pairs into a JSON object (MySQL 5.7+) | JSON_OBJECTAGG(key, value) |

